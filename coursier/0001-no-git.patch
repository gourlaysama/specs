From 6a45a8e2b114cbe09cafa78c2418009ed4e473dd Mon Sep 17 00:00:00 2001
From: Antoine Gourlay <antoine@gourlay.fr>
Date: Mon, 7 Feb 2022 22:48:47 +0100
Subject: [PATCH] no git

---
 project/modules/shared.sc | 24 +++---------------------
 1 file changed, 3 insertions(+), 21 deletions(-)

diff --git a/project/modules/shared.sc b/project/modules/shared.sc
index 51a27d04..6e499c4d 100644
--- a/project/modules/shared.sc
+++ b/project/modules/shared.sc
@@ -8,29 +8,11 @@ trait CsMima extends Mima {
 }
 
 def commitHash = T {
-  os.proc("git", "rev-parse", "HEAD").call().out.text.trim
+  "1f1e0ef8273d1cd25d35607802aff6ea4fd40ea1"
 }
 
-lazy val latestTaggedVersion = os.proc("git", "describe", "--abbrev=0", "--tags", "--match", "v*")
-  .call().out
-  .trim
-lazy val buildVersion = {
-  val gitHead = os.proc("git", "rev-parse", "HEAD").call().out.trim
-  val maybeExactTag = scala.util.Try {
-    os.proc("git", "describe", "--exact-match", "--tags", "--always", gitHead)
-      .call().out
-      .trim
-      .stripPrefix("v")
-  }
-  maybeExactTag.toOption.getOrElse {
-    val commitsSinceTaggedVersion =
-      os.proc('git, "rev-list", gitHead, "--not", latestTaggedVersion, "--count")
-        .call().out.trim
-        .toInt
-    val gitHash = os.proc("git", "rev-parse", "--short", "HEAD").call().out.trim
-    s"${latestTaggedVersion.stripPrefix("v")}-$commitsSinceTaggedVersion-$gitHash-SNAPSHOT"
-  }
-}
+lazy val latestTaggedVersion = "v2.1.0-M5"
+lazy val buildVersion = latestTaggedVersion.stripPrefix("v")
 
 trait CoursierPublishModule extends PublishModule with JavaModule {
   import mill.scalalib.publish._
-- 
2.34.1

